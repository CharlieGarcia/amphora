
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Instantiation Arguments Â· Amphora</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-accordion/accordion.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-bootstrap-callout/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="bootstrap.html" />
    
    
    <link rel="prev" href="../startup.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Read Me
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../startup.html">
            
                <a href="../startup.html">
            
                    
                    On Startup
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.1" data-path="instantiation.html">
            
                <a href="instantiation.html">
            
                    
                    Instantiation Arguments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="bootstrap.html">
            
                <a href="bootstrap.html">
            
                    
                    Bootstrapping
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Basics
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../basics/publishing.html">
            
                <a href="../../basics/publishing.html">
            
                    
                    Publishing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Advanced
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../upgrade.html">
            
                <a href="../../upgrade.html">
            
                    
                    Data Versioning (Upgrades)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../GLOSSARY.html">
            
                <a href="../../GLOSSARY.html">
            
                    
                    Glossary
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >Instantiation Arguments</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="instantiation">Instantiation</h1>
<p>The most basic Amphora instantiation might look something like the following code:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;express&apos;</span>),
  amphora = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;amphora&apos;</span>),
  app = express();


amphora({
  app: app <span class="hljs-comment">// An Express instance</span>
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">router</span>) </span>{
  router.listen(port, ip);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Clay listening on <span class="hljs-subst">${ip}</span>:<span class="hljs-subst">${port}</span>`</span>);
})
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) </span>{
  <span class="hljs-built_in">console</span>.error(error);
});
</code></pre>
<p>Here we create a new Express app, pass it into Amphora and then Amphora will return an Express instance that has been modified with Clay core routes for each site you have created. Once that Express instance is returned (<code>router</code> in this example), we call the <code>listen</code> function, <a href="http://expressjs.com/en/api.html#app.listen" target="_blank">just like an Express app would</a>.</p>
<p>Assuming you have configured your sites properly and have some components, you&apos;ll now be able to access any Clay core routes and any data included in <a href="bootstrap.html">internal bootstrap files</a> for components and sites will have been added.</p>
<hr>
<h2 id="instantiation-arguments">Instantiation Arguments</h2>
<p>At instantiation time Amphora accepts a config object which contains properties that affect everything from user sessions to plugins for enhanced functionality. Below is a quick list of arguments with references to further documentation resources on the subjects.</p>
<ul>
<li><p><code>app</code>: an Express instance. If one is not passed in, Amphora will create one during startup. The advantage passing an instance into Amphora is the ability to add any middleware or other configuration necessary for your specific setup.</p>
</li>
<li><p><code>providers</code>: an Array of strings which correspond to the supported authentication services in Amphora: <code>apikey</code>, <code>ldap</code>, <code>google</code>, <code>slack</code>, and <code>twitter</code>. For further information on configuring these providers see the <a href="authentication.md">Authentication</a> page.</p>
</li>
<li><p><code>sessionStore</code>: used for session management with user sessions when a provider is configured. For more information see the <a href="authentication.md">Authentication</a> page.</p>
</li>
<li><p><code>renderers</code>: an Object that references modules that can be used to transform component data into different formats. For example, <a href="https://github.com/clay/amphora-html" target="_blank">Amphora HTML</a> is a module that renders component data to HTML using Handlebars templates. Renderers abide by an API that Amphora sets forth. The <code>renderers</code> Object should contain properties whose names correspond to request extensions and whose properties are the handlers for those extensions. A <code>default</code> property is used to specify the renderer to be used when no extension is specified in a request. For more information, see the <a href="authentication.md">Renderers</a> documentation.</p>
</li>
<li><p><code>plugins</code>: an Array of Objects that have handlers for different plugin hooks that Amphora exposes. Different hooks are exposed for the startup, request and publish life cycles. For more information see the <a href="plugins.md">Plugins</a> page.</p>
</li>
<li><p><code>env</code>: an accommodation for renderers to expose environment variables used in <code>model.js</code> files on the client-side for <a href="https://github.com/clay/clay-kiln" target="_blank">Kiln</a>. These are only rendered in edit mode for a page. For a more thorough understanding of when/how these values are gathered and used, please see the <a href="models.md">Component Models</a> documentation.</p>
</li>
<li><p><code>cacheControl</code>: an Object with one argument: <code>staticMaxAge</code>, a Number which is passed through to the <a href="http://expressjs.com/en/4x/api.html#express.static" target="_blank"><code>Express.static</code></a> function as <code>maxAge</code>. Used for controlling <code>Cache-Control</code> headers for static assets. See the Express docs for more information about this argument.</p>
<ul>
<li><em>Note: this argument will be added to soon, which is why it&apos;s an Object</em></li>
</ul>
</li>
</ul>
<ul>
<li><code>bootstrap</code>: a Boolean value which defaults to <code>true</code>. When set to <code>false</code> the internal <a href="bootstrap.html#skipping-bootstrapping">bootstrapping process</a> will be skipped entirely. <strong>It&apos;s advised not to set the value to <code>false</code> for production instances.</strong></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../startup.html" class="navigation navigation-prev " aria-label="Previous page: On Startup">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="bootstrap.html" class="navigation navigation-next " aria-label="Next page: Bootstrapping">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Instantiation Arguments","level":"1.2.1","depth":2,"next":{"title":"Bootstrapping","level":"1.2.2","depth":2,"path":"docs/lifecycle/startup/bootstrap.md","ref":"docs/lifecycle/startup/bootstrap.md","articles":[]},"previous":{"title":"On Startup","level":"1.2","depth":1,"path":"docs/lifecycle/startup.md","ref":"docs/lifecycle/startup.md","articles":[{"title":"Instantiation Arguments","level":"1.2.1","depth":2,"path":"docs/lifecycle/startup/instantiation.md","ref":"docs/lifecycle/startup/instantiation.md","articles":[]},{"title":"Bootstrapping","level":"1.2.2","depth":2,"path":"docs/lifecycle/startup/bootstrap.md","ref":"docs/lifecycle/startup/bootstrap.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["github","anchorjs","accordion","bootstrap-callout"],"root":"./","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"github":{"url":"https://github.com/clay/amphora/"},"accordion":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"bootstrap-callout":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchorjs":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Amphora","gitbook":"3.2.3"},"file":{"path":"docs/lifecycle/startup/instantiation.md","mtime":"2017-10-06T20:49:10.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-10-18T21:33:04.610Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.1/anchor.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-anchorjs/anchor-style.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-accordion/accordionSelector.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

